{"ast":null,"code":"var _jsxFileName = \"E:\\\\Gautam\\\\Group-5_Car Rental System\\\\CarRental_Project\\\\car-rental_system_frontend\\\\src\\\\User\\\\Components\\\\Pay.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate } from 'react-router-dom';\nimport { useEffect } from \"react\";\nimport { IP_ADDRS } from \"../service/Constant\";\nimport swal from \"sweetalert\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Pay() {\n  _s();\n\n  const [appointmentId, setappointmentId] = useState('');\n  const [doctor, setDoctor] = useState({});\n  const [patient, setPatient] = useState({});\n  useEffect(() => {\n    let doctor = JSON.parse(sessionStorage.getItem(\"doctor\"));\n    let patient = JSON.parse(sessionStorage.getItem(\"patient\"));\n    let apptId = JSON.parse(sessionStorage.getItem(\"appt\"));\n    setDoctor(doctor);\n    setappointmentId(apptId.appointmentId);\n    setPatient(patient);\n  }, []);\n\n  function loadScript(src) {\n    return new Promise(resolve => {\n      const script = document.createElement(\"script\");\n      script.src = src;\n\n      script.onload = () => {\n        resolve(true);\n      };\n\n      script.onerror = () => {\n        resolve(false);\n      };\n\n      document.body.appendChild(script);\n    });\n  }\n\n  async function displayRazorpay() {\n    const res = await loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\n\n    if (!res) {\n      alert(\"Razorpay SDK failed to load. Are you online?\");\n      return;\n    }\n\n    let data = {\n      \"amount\": doctor.fees,\n      \"patientId\": patient.patientId,\n      \"appointmentId\": appointmentId\n    };\n    console.log(data);\n    const result = await axios.post(`${IP_ADDRS}/api/patient/appointment/pay/create_order`, data, {\n      headers: {\n        \"Authorization\": `Bearer ${patient.jwt}`\n      }\n    });\n\n    if (!result) {\n      alert(\"Server error. Are you online?\");\n      return;\n    }\n\n    var {\n      amount,\n      id: order_id,\n      currency\n    } = result.data;\n    amount = amount * 100;\n    const options = {\n      key: \"rzp_test_avqPqvBNedSxPH\",\n      // Enter the Key ID generated from the Dashboard\n      amount: amount.toString(),\n      currency: \"INR\",\n      name: \"Donation\",\n      description: \"Test Transaction\",\n      order_id: order_id,\n      handler: async function (response) {\n        const data = {\n          orderCreationId: order_id,\n          razorpayPaymentId: response.razorpay_payment_id,\n          razorpayOrderId: response.razorpay_order_id,\n          razorpaySignature: response.razorpay_signature,\n          patientId: patient.patientId,\n          appointmentId: appointmentId\n        };\n        console.log(data);\n        axios.post(`${IP_ADDRS}/api/patient/appointment/pay/update_order`, data, {\n          headers: {\n            \"Authorization\": `Bearer ${patient.jwt}`\n          }\n        }).then(res => {\n          // alert(\"Payment Success\");\n          swal(\"Payment Success\", \"You Appointment Booked, Details Sent, Redirecting to Profile Page\", \"success\"); // navigate(`/patient`);\n        }).catch(err => {\n          alert(\"error\");\n        }); // alert(\"Payment Success\");\n      },\n      prefill: {\n        name: \"\",\n        email: \"\",\n        contact: \"\"\n      },\n      notes: {\n        address: \"\"\n      },\n      theme: {\n        color: \"#61dafb\"\n      }\n    };\n    const paymentObject = new window.Razorpay(options);\n    paymentObject.open();\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Checkout to do Payement \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"Fees to Pay to Book Appoinment \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 14\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [\"Amount : \", doctor.fees]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 17\n    }, this), \"\\u2003  \", /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-success btn-lg\",\n      onClick: displayRazorpay,\n      children: \"Confirm\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Pay, \"UO0XD+whPmsj0M2gchM6k1ok8sg=\");\n\n_c = Pay;\nexport default Pay;\n\nvar _c;\n\n$RefreshReg$(_c, \"Pay\");","map":{"version":3,"sources":["E:/Gautam/Group-5_Car Rental System/CarRental_Project/car-rental_system_frontend/src/User/Components/Pay.jsx"],"names":["React","useState","axios","useNavigate","useEffect","IP_ADDRS","swal","Pay","appointmentId","setappointmentId","doctor","setDoctor","patient","setPatient","JSON","parse","sessionStorage","getItem","apptId","loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","displayRazorpay","res","alert","data","fees","patientId","console","log","result","post","headers","jwt","amount","id","order_id","currency","options","key","toString","name","description","handler","response","orderCreationId","razorpayPaymentId","razorpay_payment_id","razorpayOrderId","razorpay_order_id","razorpaySignature","razorpay_signature","then","catch","err","prefill","email","contact","notes","address","theme","color","paymentObject","window","Razorpay","open"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport {useNavigate} from 'react-router-dom';\r\nimport { useEffect } from \"react\";\r\nimport { IP_ADDRS } from \"../service/Constant\";\r\nimport swal from \"sweetalert\";\r\n\r\nfunction Pay() {\r\n\r\n    const [appointmentId,setappointmentId] = useState('');\r\n    const [doctor, setDoctor] = useState({});\r\n    const [patient, setPatient] = useState({});\r\n\r\n\r\n    useEffect(()=>{\r\n        let doctor = JSON.parse(sessionStorage.getItem(\"doctor\"));\r\n        let patient = JSON.parse(sessionStorage.getItem(\"patient\"));\r\n        let apptId = JSON.parse(sessionStorage.getItem(\"appt\"));\r\n        setDoctor(doctor);\r\n        setappointmentId(apptId.appointmentId);\r\n        setPatient(patient);\r\n    },[])\r\n\r\n    function loadScript(src) {\r\n        return new Promise((resolve) => {\r\n            const script = document.createElement(\"script\");\r\n            script.src = src;\r\n            script.onload = () => {\r\n                resolve(true);\r\n            };\r\n            script.onerror = () => {\r\n                resolve(false);\r\n            };\r\n            document.body.appendChild(script);\r\n        });\r\n    }\r\n\r\n    async function displayRazorpay() {\r\n        const res = await loadScript(\r\n            \"https://checkout.razorpay.com/v1/checkout.js\"\r\n        );\r\n\r\n        if (!res) {\r\n            alert(\"Razorpay SDK failed to load. Are you online?\");\r\n            return;\r\n        }\r\n        let data = {\"amount\":doctor.fees, \"patientId\":patient.patientId,\r\n                    \"appointmentId\":appointmentId};\r\n                    console.log(data);\r\n        const result = await axios.post(`${IP_ADDRS}/api/patient/appointment/pay/create_order`,data,{ headers: {\"Authorization\" : `Bearer ${patient.jwt}`}});\r\n\r\n        if (!result) {\r\n            alert(\"Server error. Are you online?\");\r\n            return;\r\n        }\r\n\r\n        var { amount, id: order_id, currency } = result.data;\r\n        amount = amount * 100;\r\n\r\n        const options = {\r\n            key: \"rzp_test_avqPqvBNedSxPH\", // Enter the Key ID generated from the Dashboard\r\n            amount: amount.toString(),\r\n            currency: \"INR\",\r\n            name: \"Donation\",\r\n            description: \"Test Transaction\",\r\n            order_id: order_id,\r\n            handler: async function (response) {\r\n                const data = {\r\n                    orderCreationId: order_id,\r\n                    razorpayPaymentId: response.razorpay_payment_id,\r\n                    razorpayOrderId: response.razorpay_order_id,\r\n                    razorpaySignature: response.razorpay_signature,\r\n                    patientId:patient.patientId,\r\n                    appointmentId:appointmentId\r\n                }; \r\n                console.log(data);\r\n\r\n                axios.post(`${IP_ADDRS}/api/patient/appointment/pay/update_order`, data ,{ headers: {\"Authorization\" : `Bearer ${patient.jwt}`}})\r\n                .then(res=>{\r\n                    // alert(\"Payment Success\");\r\n                    swal(\"Payment Success\",\"You Appointment Booked, Details Sent, Redirecting to Profile Page\",\"success\");\r\n                // navigate(`/patient`);\r\n                })\r\n                .catch(err=>{alert(\"error\")});\r\n\r\n                // alert(\"Payment Success\");\r\n            },\r\n            prefill: {\r\n                name: \"\",\r\n                email: \"\",\r\n                contact: \"\",\r\n            },\r\n            notes: {\r\n                address: \"\",\r\n            },\r\n            theme: {\r\n                color: \"#61dafb\",\r\n            },\r\n        };\r\n\r\n        const paymentObject = new window.Razorpay(options);\r\n        paymentObject.open();\r\n    }\r\n\r\n    return (\r\n        <div >\r\n            <h1>Checkout to do Payement </h1>\r\n             <label>Fees to Pay to Book Appoinment </label>\r\n                <h3>Amount : {doctor.fees}</h3>\r\n              &emsp;  <button className=\"btn btn-success btn-lg\" onClick={displayRazorpay}>\r\n                   Confirm \r\n                </button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Pay;"]},"metadata":{},"sourceType":"module"}