{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rd273\\\\Desktop\\\\RentPeCar\\\\Group-5_RentPeCar\\\\CarRental_Project\\\\RentPeCar_Frontend\\\\src\\\\User\\\\Components\\\\Pay.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport axios from \"axios\";\nimport { useEffect } from \"react\";\nimport swal from \"sweetalert\";\nimport { useHistory } from \"react-router\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction Pay() {\n  _s();\n\n  const [amount, setAmount] = useState('');\n  const [appointmentId, setappointmentId] = useState('');\n  const [doctor, setDoctor] = useState({});\n  const [patient, setPatient] = useState({});\n  const [bookingId, setBookingId] = useState('');\n  const history = useHistory();\n  useEffect(() => {\n    // let obj = JSON.parse(sessionStorage.getItem(\"amount\"));\n    // console.log(obj.amount);\n    // setAmount(obj.amount);\n    let book = JSON.parse(sessionStorage.getItem(\"conBooking\"));\n    let bookId = book.data.bookingId;\n    console.log(book);\n    console.log(bookId);\n    setBookingId(bookId);\n  }, []);\n\n  function loadScript(src) {\n    return new Promise(resolve => {\n      const script = document.createElement(\"script\");\n      script.src = src;\n\n      script.onload = () => {\n        resolve(true);\n      };\n\n      script.onerror = () => {\n        resolve(false);\n      };\n\n      document.body.appendChild(script);\n    });\n  }\n\n  async function displayRazorpay() {\n    const res = await loadScript(\"https://checkout.razorpay.com/v1/checkout.js\");\n\n    if (!res) {\n      alert(\"Razorpay SDK failed to load. Are you Online?\");\n      return;\n    }\n\n    let data = {\n      \"amount\": doctor.fees,\n      \"patientId\": patient.patientId,\n      \"appointmentId\": appointmentId\n    };\n    console.log(data);\n    console.log(amount);\n    let obj = {\n      \"amount\": JSON.parse(sessionStorage.getItem(\"amount\"))\n    };\n    const result = await axios.post(`http://localhost:4000/api/pay/create_order`, obj);\n\n    if (!result) {\n      alert(\"Server error. Are you Online?\");\n      return;\n    }\n\n    sessionStorage.removeItem(\"amount\");\n    var {\n      amount,\n      id: order_id,\n      currency\n    } = result.data;\n    amount = amount * 100;\n    const options = {\n      key: \"rzp_test_htD0V8iqnPJHNN\",\n      // Enter the Key ID generated from the Dashboard\n      amount: data.amount.toString(),\n      currency: data.currency,\n      name: \"Donation\",\n      description: \"Test Transaction\",\n      order_id: order_id,\n      handler: async function (response) {\n        const data = {\n          amount: response.amount.toString(),\n          orderCreationId: response.order_id,\n          razorpayPaymentId: response.razorpay_payment_id,\n          razorpayOrderId: response.razorpay_order_id,\n          razorpaySignature: response.razorpay_signature\n        };\n        console.log(data);\n        let d = {\n          \"bookingid\": data.bookingId,\n          \"razorpayPaymentId\": data.razorpayPaymentId\n        };\n        axios.put(`http://localhost:4000/api/pay/update_pay_order`, data).then(res => {\n          // alert(\"Payment Success\");\n          swal(\"Payment Successful\", \"Your Car is Booked, Details Sent, Redirecting to Profile Page\", \"success\"); // navigate(`/patient`);\n\n          history.push(`/car_type`);\n        }).catch(err => {\n          alert(\"error\");\n        }); // alert(\"Payment Success\");\n      },\n      prefill: {\n        name: data.name,\n        email: \"\",\n        contact: \"\"\n      },\n      notes: {\n        address: \"\"\n      },\n      theme: {\n        color: \"#61dafb\"\n      }\n    };\n    const paymentObject = new window.Razorpay(options);\n    paymentObject.open();\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Checkout to do Payement \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n      children: \"Amount left to Pay : \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 14\n    }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: [\"Amount : \", JSON.parse(sessionStorage.getItem(\"amount\"))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 17\n    }, this), \"\\u2003  \", /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-success btn-lg\",\n      onClick: displayRazorpay,\n      children: \"Confirm\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 23\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Pay, \"oRFjhZykHJkFeyCVjFE/Ztrn7Uw=\", false, function () {\n  return [useHistory];\n});\n\n_c = Pay;\nexport default Pay;\n\nvar _c;\n\n$RefreshReg$(_c, \"Pay\");","map":{"version":3,"names":["React","useState","axios","useEffect","swal","useHistory","Pay","amount","setAmount","appointmentId","setappointmentId","doctor","setDoctor","patient","setPatient","bookingId","setBookingId","history","book","JSON","parse","sessionStorage","getItem","bookId","data","console","log","loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","displayRazorpay","res","alert","fees","patientId","obj","result","post","removeItem","id","order_id","currency","options","key","toString","name","description","handler","response","orderCreationId","razorpayPaymentId","razorpay_payment_id","razorpayOrderId","razorpay_order_id","razorpaySignature","razorpay_signature","d","put","then","push","catch","err","prefill","email","contact","notes","address","theme","color","paymentObject","window","Razorpay","open"],"sources":["C:/Users/rd273/Desktop/RentPeCar/Group-5_RentPeCar/CarRental_Project/RentPeCar_Frontend/src/User/Components/Pay.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useEffect } from \"react\";\r\nimport swal from \"sweetalert\";\r\nimport { useHistory } from \"react-router\";\r\n\r\nfunction Pay() {\r\n    const [amount, setAmount] = useState('');\r\n    const [appointmentId,setappointmentId] = useState('');\r\n    const [doctor, setDoctor] = useState({});\r\n    const [patient, setPatient] = useState({});\r\n    const [bookingId, setBookingId] = useState('');\r\n    const history = useHistory();\r\n\r\n\r\n    useEffect(()=>{\r\n        // let obj = JSON.parse(sessionStorage.getItem(\"amount\"));\r\n        // console.log(obj.amount);\r\n        \r\n        // setAmount(obj.amount);\r\n        let book = JSON.parse(sessionStorage.getItem(\"conBooking\"))\r\n        let bookId = book.data.bookingId;\r\n        console.log(book);\r\n        console.log(bookId);\r\n        setBookingId(bookId);\r\n\r\n        \r\n    },[])\r\n\r\n    function loadScript(src) {\r\n        return new Promise((resolve) => {\r\n            const script = document.createElement(\"script\");\r\n            script.src = src;\r\n            script.onload = () => {\r\n                resolve(true);\r\n            };\r\n            script.onerror = () => {\r\n                resolve(false);\r\n            };\r\n            document.body.appendChild(script);\r\n        });\r\n    }\r\n\r\n    async function displayRazorpay() {\r\n        const res = await loadScript(\r\n            \"https://checkout.razorpay.com/v1/checkout.js\"\r\n        );\r\n\r\n        if (!res) {\r\n            alert(\"Razorpay SDK failed to load. Are you Online?\");\r\n            return;\r\n        }\r\n        let data = {\"amount\":doctor.fees, \"patientId\":patient.patientId,\r\n                    \"appointmentId\":appointmentId};\r\n                    console.log(data);\r\n                    console.log(amount);\r\n                    \r\n                    let obj = {\"amount\":JSON.parse(sessionStorage.getItem(\"amount\"))}\r\n        const result = await axios.post(`http://localhost:4000/api/pay/create_order`,obj);\r\n\r\n        if (!result) {\r\n            alert(\"Server error. Are you Online?\");\r\n            return;\r\n        }\r\n        sessionStorage.removeItem(\"amount\");\r\n\r\n        var { amount, id: order_id, currency } = result.data;\r\n        amount = amount * 100;\r\n\r\n        const options = {\r\n            key: \"rzp_test_htD0V8iqnPJHNN\", // Enter the Key ID generated from the Dashboard\r\n            amount: data.amount.toString(),\r\n            currency: data.currency,\r\n            name: \"Donation\",\r\n            description: \"Test Transaction\",\r\n            order_id: order_id,\r\n            handler: async function (response) {\r\n                const data = {\r\n                    amount : response.amount.toString(),\r\n                    orderCreationId: response.order_id,\r\n                    razorpayPaymentId: response.razorpay_payment_id,\r\n                    razorpayOrderId: response.razorpay_order_id,\r\n                    razorpaySignature: response.razorpay_signature,\r\n                }; \r\n                console.log(data);\r\n                let d = {\"bookingid\": data.bookingId,\r\n                         \"razorpayPaymentId\": data.razorpayPaymentId};\r\n\r\n                axios.put(`http://localhost:4000/api/pay/update_pay_order`, data)\r\n                .then(res=>{\r\n                    // alert(\"Payment Success\");\r\n                    swal(\"Payment Successful\",\"Your Car is Booked, Details Sent, Redirecting to Profile Page\",\"success\");\r\n                // navigate(`/patient`);\r\n                history.push(`/car_type`);\r\n                })\r\n                .catch(err=>{alert(\"error\")});\r\n\r\n                // alert(\"Payment Success\");\r\n            },\r\n            prefill: {\r\n                name: data.name,\r\n                email: \"\",\r\n                contact: \"\",\r\n            },\r\n            notes: {\r\n                address: \"\",\r\n            },\r\n            theme: {\r\n                color: \"#61dafb\",\r\n            },\r\n        };\r\n\r\n        const paymentObject = new window.Razorpay(options);\r\n        paymentObject.open();\r\n    }\r\n\r\n    return (\r\n        <div >\r\n            <h1>Checkout to do Payement </h1>\r\n             <label>Amount left to Pay : </label>\r\n                <h3>Amount : {JSON.parse(sessionStorage.getItem(\"amount\"))}</h3>\r\n              &emsp;  <button className=\"btn btn-success btn-lg\" onClick={displayRazorpay}>\r\n                   Confirm \r\n                </button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Pay;"],"mappings":"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"},"metadata":{},"sourceType":"module"}